<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Contact Form</title>

    <!-- SurveyJS Dependencies -->
    <script src="https://unpkg.com/jquery@3.7.1"></script>
    <script src="https://unpkg.com/survey-jquery@1.9.116/survey.jquery.min.js"></script>
    <link href="https://unpkg.com/survey-jquery@1.9.116/defaultV2.min.css" type="text/css" rel="stylesheet">
    <link rel="stylesheet" href="https://therealtimex.github.io/rtlibrary/css/md-styles.css">

    <!-- Load external survey data -->
    <script src="https://therealtimex.github.io/rtlibrary/js/form-contact-1.js"></script>
</head>

<body>
    <div class="survey-container">
        <div class="language-selector">
            <button class="language-btn active" onclick="changeLanguage('en')">EN</button>
            <button class="language-btn" onclick="changeLanguage('fr')">FR</button>
            <button class="language-btn" onclick="changeLanguage('vi')">VI</button>
        </div>
        <div id="surveyContainer"></div>
    </div>

    <!-- Survey Processing Code -->
    <script>
        class SurveyManager {
            constructor(containerId, surveyData) {
                this.containerId = containerId;
                this.surveyData = surveyData;
                this.survey = null;
                this.init();
            }

            init() {
                this.survey = new Survey.Model(this.surveyData);
                this.setupTheme();
                this.setupEventHandlers();
                this.render();
            }

            setupTheme() {
                Survey.StylesManager.applyTheme("defaultV2");
            }

            setupEventHandlers() {
                this.survey.onComplete.add(this.handleSubmission.bind(this));
            }

            handleSubmission(sender, options) {
                const results = JSON.stringify(sender.data);
                console.log('Form Data:', results);
                this.showSuccessMessage(sender.locale);
            }

            showSuccessMessage(locale) {
                alert(successMessages[locale]);
            }

            render() {
                $(`#${this.containerId}`).Survey({ model: this.survey });
            }

            changeLanguage(lang) {
                this.survey.locale = lang;
                this.updateLanguageButtons(lang);
            }

            updateLanguageButtons(lang) {
                document.querySelectorAll('.language-btn').forEach(btn => {
                    btn.classList.toggle('active', btn.textContent.toLowerCase() === lang);
                });
            }
        }

        // Initialize survey when the external data is loaded
        document.addEventListener('DOMContentLoaded', () => {
            if (typeof surveyData !== 'undefined' && typeof successMessages !== 'undefined') {
                const surveyManager = new SurveyManager('surveyContainer', surveyData);
            } else {
                console.error('Survey data not loaded properly');
            }
        });

        // Global function for language switching
        function changeLanguage(lang) {
            window.surveyManager?.changeLanguage(lang);
        }
    </script>
</body>
</html>